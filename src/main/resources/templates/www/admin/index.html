<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Librería - Administración</title>

    <!-- Estilos CSS -->
    <link rel="stylesheet" th:href="@{/css/stylesAdmin.css}" />
    <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}" />
</head>
<body>
<div layout:fragment="MainBase">
    <div class="container">
        <div class="container">
            <h2>Editar libros</h2>
            <form id="editForm" th:action="@{/actualizar}" method="post">
                <input type="hidden" id="editId" name="id">
                <label for="editTitulo">Título:</label>
                <input type="text" id="editTitulo" name="titulo" required>
                <label for="editAutor">Autor:</label>
                <input type="text" id="editAutor" name="autor">
                <label for="editCategoria">Categoría:</label>
                <input type="text" id="editCategoria" name="categoria">
                <label for="editPrecio">Precio:</label>
                <input type="number" id="editPrecio" name="precio" step="0.01">
                <button type="submit">Actualizar</button>
            </form>
        </div>
        <!-- Tabla de Libros -->
        <section id="libros">
            <h2>Listado de Libros</h2>
            <a th:href="@{/libro/nuevo}">Añadir Libro</a>
            <table class="striped">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Titulo</th>
                        <th>ID Autor</th>
                        <th>ID Categoria</th>
                        <th>Precio</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="libro : ${libros}">
                        <td th:text="${libro.id}"></td>
                        <td th:text="${libro.titulo}"></td>
                        <td th:text="${libro.autor.id}"></td>
                        <td th:text="${libro.categoria.id}"></td>
                        <td th:text="${libro.precio}"></td>
                        <td>
                            <a th:href="@{/editar/{id}(id=${libro.id})}">Editar</a>
                            <a th:href="@{/libro/eliminar/{id}(id=${libro.id})}" onclick="return confirm('¿Seguro que deseas eliminar este libro?');">Eliminar</a>
                        </td>
                        
                    </tr>
                </tbody>
            </table>
        </section>
        
        <!-- Tabla de Categorías -->
        <section id="categorias">
            <h2>Listado de Categorías</h2>
            <a th:href="@{/categoria/nueva}">Añadir Categoría</a>
            <table class="striped">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Nombre</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="categoria : ${categorias}">
                        <td th:text="${categoria.id}"></td>
                        <td th:text="${categoria.nombre}"></td>
                        <td>
                            <a th:href="@{/categoria/editar/{id}(id=${categoria.id})}">Editar</a>
                            <a th:href="@{/categoria/eliminar/{id}(id=${categoria.id})}" onclick="return confirm('¿Seguro que deseas eliminar esta categoría?');">Eliminar</a>
                        </td>
                    </tr>
                </tbody>
            </table>
        </section>
        
        <section id="autores">
            <h2>Listado de Autores</h2>
            <table class="striped">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Nombre</th>
                        <th>Fecha Nac</th>
                        <th>Nacionalidad</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="autor : ${autores}">
                        <td th:text="${autor.id}"></td> 
                        <td th:text="${autor.nombre}"></td>
                        <td th:text="${autor.fechaNacimiento}"></td>
                        <td th:text="${autor.nacionalidad}"></td>
                        <td>
                            <button type="submit">Actualizar</button>
                            <a th:href="@{/autor/eliminar/{id}(id=${autor.id})}" onclick="return confirm('¿Seguro que deseas eliminar este autor?');">Eliminar</a>
                        </td>
                    </tr>
                </tbody>
            </table>
        </section>
        <section id="usuarios">
            <h2>Listado de Usuarios</h2>
            <table class="striped">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Direccion</th>
                        <th>Email</th>
                        <th>Nombre</th>
                        <th>Contraseña</th>
                        <th>Telefono</th>
                        <th>Rol</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="usuario : ${usuarios}">
                        <td th:text="${usuario.id}"></td>
                        <td th:text="${usuario.direccion}"></td> 
                        <td th:text="${usuario.email}"></td>
                        <td th:text="${usuario.nombre}"></td>
                        <td th:text="${usuario.password}"></td>
                        <td th:text="${usuario.telefono}"></td>
                        <td th:text="${usuario.rol}"></td>
                        <td>
                            <a th:href="@{/usuario/editar/{id}(id=${usuario.id})}">Editar</a>
                            <a th:href="@{/usuario/eliminar/{id}(id=${usuario.id})}" onclick="return confirm('¿Seguro que deseas eliminar este autor?');">Eliminar</a>
                        </td>
                    </tr>
                    
                </tbody>
            </table>
        </section>
    </div>
    </div>
</div>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        const editForm = document.getElementById("editForm");
        const editId = document.getElementById("editId");
        const editTitulo = document.getElementById("editTitulo");
        const editAutor = document.getElementById("editAutor");
        const editCategoria = document.getElementById("editCategoria");
        const editPrecio = document.getElementById("editPrecio");
        
        document.querySelectorAll(".edit-btn").forEach(button => {
            button.addEventListener("click", function() {
                editId.value = this.getAttribute("data-id");
                editTitulo.value = this.getAttribute("data-titulo");
                editAutor.value = this.getAttribute("data-autor");
                editCategoria.value = this.getAttribute("data-categoria");
                editPrecio.value = this.getAttribute("data-precio");
            });
        });
    });
</script>
</body>

</html>